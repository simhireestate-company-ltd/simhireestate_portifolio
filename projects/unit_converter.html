<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SimHireEstate Unit Converter</title>
  <link rel="icon" href="../assets/logo.png" />
  <style>
    :root { --brand-primary:#063F5E; --brand-secondary:#1a1a69; --brand-gray:#6B7280; }
    * { box-sizing: border-box; }
    body {
      min-height: 100vh;
      margin: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
      color: #111827;
      padding: 20px;
    }
    .container {
      width: 100%;
      max-width: 900px;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.12);
      overflow: hidden;
    }
    header {
      padding: 20px 24px 0 24px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }
    header img { height: 28px; width: auto; }
    header h1 { margin: 0; font-size: 1.6rem; font-weight: 650; color: #1f2937; }
    header p { margin: 0 0 12px; color: #6b7280; font-size: .95rem; text-align: center; }

    .content { padding: 0 24px 24px; }

    .panel {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 14px;
      padding: 16px;
    }
    @media (min-width: 760px) {
      .panel { grid-template-columns: 1.2fr 1fr 1fr; align-items: end; }
    }

    label { display:block; font-size:.9rem; color:#374151; margin-bottom:6px; font-weight: 500; }
    select, input[type="number"] {
      width: 100%;
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      padding: 10px 12px;
      font-size: 1rem;
      outline: none;
      transition: border-color .2s ease;
      background: #fff;
    }
    select:focus, input[type="number"]:focus { border-color: var(--brand-secondary); }

    .controls { display: grid; gap: 10px; grid-template-columns: 1fr auto 1fr; align-items: end; }
    .swap-btn {
      background: var(--brand-secondary);
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 10px 12px;
      font-size: .95rem;
      cursor: pointer;
      transition: background .2s ease, transform .05s;
      height: 42px;
      align-self: end;
    }
    .swap-btn:hover { background: #131357; }
    .swap-btn:active { transform: translateY(1px); }

    .result {
      margin-top: 16px;
      background: #fff;
      border: 1px solid #e5e7eb;
      border-radius: 14px;
      padding: 16px;
    }
    .primary-text { color: var(--brand-primary); font-weight: 600; }
    .muted { color: #6b7280; }

    .grid-two {
      margin-top: 16px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }
    @media (min-width: 760px) { .grid-two { grid-template-columns: 1fr 1fr; } }

    .card {
      background: #fff;
      border: 1px solid #e5e7eb;
      border-radius: 14px;
      padding: 16px;
      min-height: 140px;
    }

    .table {
      width: 100%;
      border-collapse: collapse;
      font-size: .95rem;
    }
    .table th, .table td { text-align: left; padding: 8px 6px; }
    .table thead th { color:#374151; border-bottom: 1px solid #e5e7eb; font-weight: 600; }
    .table tbody tr + tr td { border-top: 1px dashed #e5e7eb; }

    .error { color: #b91c1c; font-size: .9rem; margin-top: 8px; text-align:center; }
    footer { text-align: center; color:#6b7280; font-size:.85rem; padding: 10px 0 18px; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div style="display:flex; align-items:center; justify-content:center; gap:10px;">
        <img src="../assets/logo.png" alt="SimHireEstate" />
      </div>
      <h1>SimHireEstate Unit Converter</h1>
      <p>Convert length, mass, area, volume, speed, and temperature with precision. Frontend only.</p>
    </header>

    <div class="content">
      <div class="panel">
        <div>
          <label for="category">Category</label>
          <select id="category"></select>
        </div>
        <div>
          <label for="value">Value</label>
          <input type="number" id="value" placeholder="Enter value" value="1" step="any" />
        </div>
        <div class="controls">
          <div>
            <label for="fromUnit">From</label>
            <select id="fromUnit"></select>
          </div>
          <button class="swap-btn" id="swapBtn" title="Swap units">Swap</button>
          <div>
            <label for="toUnit">To</label>
            <select id="toUnit"></select>
          </div>
        </div>
      </div>

      <div class="result" id="resultBox">
        <div id="resultText" class="primary-text"></div>
        <div id="error" class="error"></div>
      </div>

      <div class="grid-two">
        <div class="card">
          <div style="font-weight:600; margin-bottom:8px; color:#374151">Quick conversions (to all units)</div>
          <div class="muted" style="font-size:.9rem">Based on current input and selection</div>
          <div style="overflow:auto; margin-top:10px">
            <table class="table" id="tableAll">
              <thead>
                <tr><th>Unit</th><th>Value</th></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
        <div class="card">
          <div style="font-weight:600; margin-bottom:8px; color:#374151">Tips</div>
          <ul class="muted" style="margin:0; padding-left: 18px; line-height: 1.6">
            <li>Use the swap button to quickly invert units.</li>
            <li>Temperature conversions use non-linear formulas.</li>
            <li>Your last selections are remembered on this device.</li>
            <li>Results are formatted for readability; copy exact number from the table if needed.</li>
          </ul>
        </div>
      </div>

      <footer>© <span id="year"></span> SimHireEstate</footer>
    </div>
  </div>

  <script>
    // Year injection
    document.getElementById('year').textContent = new Date().getFullYear();

    // Data model: factors are multipliers to convert a unit to the base unit
    const DATA = {
      length: {
        label: 'Length', base: 'm',
        units: {
          'mm': 0.001,
          'cm': 0.01,
          'm': 1,
          'km': 1000,
          'in': 0.0254,
          'ft': 0.3048,
          'yd': 0.9144,
          'mi': 1609.344
        },
        names: {
          'mm': 'millimeter (mm)',
          'cm': 'centimeter (cm)',
          'm' : 'meter (m)',
          'km': 'kilometer (km)',
          'in': 'inch (in)',
          'ft': 'foot (ft)',
          'yd': 'yard (yd)',
          'mi': 'mile (mi)'
        }
      },
      mass: {
        label: 'Mass / Weight', base: 'kg',
        units: {
          'mg': 0.000001,
          'g' : 0.001,
          'kg': 1,
          't' : 1000,
          'oz': 0.028349523125,
          'lb': 0.45359237
        },
        names: {
          'mg': 'milligram (mg)',
          'g' : 'gram (g)',
          'kg': 'kilogram (kg)',
          't' : 'tonne (t)',
          'oz': 'ounce (oz)',
          'lb': 'pound (lb)'
        }
      },
      area: {
        label: 'Area', base: 'm²',
        units: {
          'mm²': 0.000001,
          'cm²': 0.0001,
          'm²' : 1,
          'km²': 1_000_000,
          'ha' : 10_000,
          'acre': 4046.8564224,
          'in²': 0.00064516,
          'ft²': 0.09290304,
          'yd²': 0.83612736
        },
        names: {
          'mm²': 'square millimeter (mm²)',
          'cm²': 'square centimeter (cm²)',
          'm²' : 'square meter (m²)',
          'km²': 'square kilometer (km²)',
          'ha' : 'hectare (ha)',
          'acre': 'acre',
          'in²': 'square inch (in²)',
          'ft²': 'square foot (ft²)',
          'yd²': 'square yard (yd²)'
        }
      },
      volume: {
        label: 'Volume', base: 'L',
        units: {
          'mL': 0.001,
          'L' : 1,
          'm³': 1000,
          'tsp': 0.00492892159375, // US teaspoon
          'tbsp': 0.01478676478125, // US tablespoon
          'cup': 0.2365882365, // US cup
          'pt' : 0.473176473, // US pint
          'qt' : 0.946352946, // US quart
          'gal': 3.785411784, // US gallon
          'in³': 0.016387064, // cubic inch
          'ft³': 28.316846592 // cubic foot
        },
        names: {
          'mL': 'milliliter (mL)',
          'L' : 'liter (L)',
          'm³': 'cubic meter (m³)',
          'tsp': 'teaspoon (tsp)',
          'tbsp': 'tablespoon (tbsp)',
          'cup': 'cup (US)',
          'pt' : 'pint (US pt)',
          'qt' : 'quart (US qt)',
          'gal': 'gallon (US gal)',
          'in³': 'cubic inch (in³)',
          'ft³': 'cubic foot (ft³)'
        }
      },
      speed: {
        label: 'Speed', base: 'm/s',
        units: {
          'm/s': 1,
          'km/h': 0.27777777777778,
          'mph': 0.44704,
          'knot': 0.514444,
          'ft/s': 0.3048
        },
        names: {
          'm/s': 'meter per second (m/s)',
          'km/h': 'kilometer per hour (km/h)',
          'mph': 'mile per hour (mph)',
          'knot': 'knot (kn)',
          'ft/s': 'foot per second (ft/s)'
        }
      },
      temperature: {
        label: 'Temperature', base: '°C',
        // handled by formulas
        units: { '°C': 1, '°F': 1, 'K': 1 },
        names: { '°C': 'Celsius (°C)', '°F': 'Fahrenheit (°F)', 'K': 'Kelvin (K)' }
      }
    };

    // Elements
    const categoryEl = document.getElementById('category');
    const valueEl = document.getElementById('value');
    const fromEl = document.getElementById('fromUnit');
    const toEl = document.getElementById('toUnit');
    const swapBtn = document.getElementById('swapBtn');
    const resultText = document.getElementById('resultText');
    const errorEl = document.getElementById('error');
    const tableAll = document.getElementById('tableAll').querySelector('tbody');

    // Helpers
    const LS_KEYS = { cat: 'unitConvCategory', from: 'unitConvFrom', to: 'unitConvTo' };

    function formatNumber(n) {
      if (!isFinite(n)) return String(n);
      // Use locale formatting with up to 8 decimal places
      const abs = Math.abs(n);
      const options = abs !== 0 && (abs < 0.0001 || abs > 1e7)
        ? { maximumSignificantDigits: 9 }
        : { minimumFractionDigits: 0, maximumFractionDigits: 8 };
      return n.toLocaleString(undefined, options);
    }

    function populateCategories() {
      categoryEl.innerHTML = '';
      Object.keys(DATA).forEach(key => {
        const opt = new Option(DATA[key].label, key);
        categoryEl.add(opt);
      });
    }

    function populateUnits(category, preserve) {
      const cfg = DATA[category];
      const units = Object.keys(cfg.units);
      fromEl.innerHTML = '';
      toEl.innerHTML = '';
      units.forEach(u => {
        const n = cfg.names?.[u] || u;
        fromEl.add(new Option(n, u));
        toEl.add(new Option(n, u));
      });

      // Defaults per category
      let defFrom = units[0];
      let defTo = units[1] || units[0];
      if (category === 'length') { defFrom = 'm'; defTo = 'ft'; }
      if (category === 'mass') { defFrom = 'kg'; defTo = 'lb'; }
      if (category === 'area') { defFrom = 'm²'; defTo = 'ft²'; }
      if (category === 'volume') { defFrom = 'L'; defTo = 'gal'; }
      if (category === 'speed') { defFrom = 'km/h'; defTo = 'mph'; }
      if (category === 'temperature') { defFrom = '°C'; defTo = '°F'; }

      if (preserve) {
        const savedFrom = localStorage.getItem(LS_KEYS.from);
        const savedTo = localStorage.getItem(LS_KEYS.to);
        if (savedFrom && units.includes(savedFrom)) defFrom = savedFrom;
        if (savedTo && units.includes(savedTo)) defTo = savedTo;
      }

      fromEl.value = defFrom;
      toEl.value = defTo;
    }

    function saveState() {
      localStorage.setItem(LS_KEYS.cat, categoryEl.value);
      localStorage.setItem(LS_KEYS.from, fromEl.value);
      localStorage.setItem(LS_KEYS.to, toEl.value);
    }

    function convertLinear(category, from, to, value) {
      const { units } = DATA[category];
      const toBase = units[from];
      const fromBase = units[to];
      const valueInBase = value * toBase; // value in base unit
      return valueInBase / fromBase;
    }

    function convertTemperature(from, to, value) {
      let c; // convert any to Celsius first
      if (from === '°C') c = value;
      else if (from === '°F') c = (value - 32) * 5/9;
      else if (from === 'K') c = value - 273.15;
      else return NaN;

      if (to === '°C') return c;
      if (to === '°F') return (c * 9/5) + 32;
      if (to === 'K') return c + 273.15;
      return NaN;
    }

    function convert(category, from, to, value) {
      if (category === 'temperature') return convertTemperature(from, to, value);
      return convertLinear(category, from, to, value);
    }

    function updateResult() {
      errorEl.textContent = '';
      const category = categoryEl.value;
      const from = fromEl.value;
      const to = toEl.value;
      const raw = parseFloat(valueEl.value);

      if (!isFinite(raw)) {
        resultText.textContent = '';
        errorEl.textContent = 'Please enter a valid number.';
        tableAll.innerHTML = '';
        return;
      }

      const out = convert(category, from, to, raw);
      if (!isFinite(out)) {
        resultText.textContent = '';
        errorEl.textContent = 'Conversion failed for the selected units.';
        tableAll.innerHTML = '';
        return;
      }

      resultText.textContent = `${formatNumber(raw)} ${from} = ${formatNumber(out)} ${to}`;
      buildAllTable(category, from, raw);
      saveState();
    }

    function buildAllTable(category, from, raw) {
      const cfg = DATA[category];
      const units = Object.keys(cfg.units);
      const rows = [];

      if (category === 'temperature') {
        ['°C','°F','K'].forEach(u => {
          const val = convertTemperature(from, u, raw);
          rows.push(`<tr><td>${u}</td><td>${formatNumber(val)}</td></tr>`);
        });
      } else {
        units.forEach(u => {
          const val = convertLinear(category, from, u, raw);
          rows.push(`<tr><td>${u}</td><td>${formatNumber(val)}</td></tr>`);
        });
      }
      tableAll.innerHTML = rows.join('');
    }

    // Event listeners
    categoryEl.addEventListener('change', () => {
      populateUnits(categoryEl.value, true);
      updateResult();
    });
    valueEl.addEventListener('input', updateResult);
    fromEl.addEventListener('change', updateResult);
    toEl.addEventListener('change', updateResult);
    swapBtn.addEventListener('click', () => {
      const tmp = fromEl.value;
      fromEl.value = toEl.value;
      toEl.value = tmp;
      updateResult();
    });

    // Init
    (function init(){
      populateCategories();
      const savedCat = localStorage.getItem(LS_KEYS.cat);
      categoryEl.value = savedCat && DATA[savedCat] ? savedCat : 'length';
      populateUnits(categoryEl.value, true);
      updateResult();
    })();
  </script>
</body>
</html>